<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Gráficos con ggplot2.  (A): Primeras ideas</title>
    <meta charset="utf-8" />
    <meta name="author" content="Pedro J. Pérez" />
    <meta name="author" content="2020, septiembre" />
    <meta name="github-repo" content="perezp44/intro-ds-20-21-web"/>
    <meta name="twitter:title" content="Gráficos con ggplot2: Primeras ideas"/>
    <meta name="twitter:description" content="Se presentan conceptos e ideas básicas sobre visualización con el paquete ggplot2 de R. En primer lugar se presentan las ideas básicas, para después exponer los distintos elementos o layers de los gráficos ggplot."/>
    <meta name="twitter:url" content="https://perezp44.github.io/intro-ds-20-21-web/slides/ss_06_ggplot2/ss_06_ggplot2_A.html#1"/>
    <meta name="twitter:card" content="summary"/>
    <meta property="og:title" content="Gráficos con ggplot2: Primeras ideas"/>
    <meta property="og:description" content="Se presentan conceptos e ideas básicas sobre visualización con el paquete ggplot2 de R. En primer lugar se presentan las ideas básicas, para después exponer los distintos elementos o layers de los gráficos ggplot."/>
    <meta property="og:url" content="https://perezp44.github.io/intro-ds-20-21-web/slides/ss_06_ggplot2/ss_06_ggplot2_A.html#1"/>
    <meta property="og:type" content="website"/>
    <meta property="og:locale" content="en_US"/>
    <meta property="article:author" content="Pedro J. Pérez"/>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <script src="libs/xaringanExtra_fit-screen/fit-screen.js"></script>
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="libs/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" href="https://perezp44.github.io/intro-ds-20-21-web/favicon-yo.ico" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-71846326-6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'UA-71846326-6');
    </script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">





















class: inverse, center, middle
# Gráficos con ggplot2. &lt;br&gt;(A): Primeras ideas
##### (Slides 06(A) del curso Programación y manejo de datos con R)

### Pedro J. Pérez  

#### Universitat de València 
#### 2020, octubre 
###### (actualizadas el 25-10-2020)

&lt;br&gt;&lt;br&gt;&lt;br&gt;
#### e-mail: [<i class="fas  fa-envelope "></i>](mailto:pedro.j.perez@uv.es)[pedro.j.perez@uv.es](mailto:pedro.j.perez@uv.es)

#### Web del curso: [<i class="fas  fa-link "></i>](https://perezp44.github.io/intro-ds-20-21-web/) https://perezp44.github.io/intro-ds-20-21-web/  
<style>.shareagain-bar {
--shareagain-foreground: rgb(255, 255, 255);
--shareagain-background: rgba(0, 0, 0, 0.5);
--shareagain-facebook: none;
--shareagain-pinterest: none;
--shareagain-reddit: none;
}</style>


---
class: inverse, center, middle
background-image: url(imagenes/ss_06_img_01_ggplot2-hex.png)
background-position: 95% 5%
background-size: 10%

## Gráficos chulos con *ggplot2*

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

#### Uno de los mejores (que dices!?, el MEJOR!!!) sistema gráfico del MUNDO.

---
background-image: url(imagenes/ss_06_img_01_ggplot2-hex.png)
background-position: 98% 2%
background-size: 5%

- El **análisis gráfico es fundamental** al presentar resultados, pero también en el análisis exploratorio: permite descubrir relaciones entre variables, y descartar o sugerir nuevas preguntas sobre los datos.


&lt;img src="./imagenes/tt_06_img_01_explore-visualice.png" width="75%" style="display: block; margin: auto;" /&gt;

--

--------------------------------------

&lt;br&gt;

- R tiene varios sistemas gráficos, pero **usaremos ggplot2**

- *ggplot2* es un paquete de R para producir gráficos estadísticos. Bueno, en realidad **es todo un ecosistema**. Mira sus extensiones [[aquí]](https://exts.ggplot2.tidyverse.org/gallery/).

- Es diferente porque tiene una **gramática subyacente**, basada en Grammar of Graphics (Wilkinson 2005).

- Cuesta un poco (sólo un poco) más empezar, pero enseguida se ven los beneficios; además, es que **ahora mismo es el estándar**. 

---
class: inverse, center, middle
background-image: url(imagenes/ss_06_img_01_ggplot2-hex.png)
background-position: 95% 5%
background-size: 10%

## Primeras ideas sobre *ggplot2*

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

#### Primeras ideas para empezar a familiarizarnos con *ggplot2*

---
background-image: url(imagenes/ss_06_img_01_ggplot2-hex.png)
background-position: 98% 2%
background-size: 5%

##### ¿qué vemos en el gráfico de abajo?


.pull-left[
&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-5-1.png" width="99%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[

&lt;br&gt;

- gráfico de puntos  

- se representan 3 variables

- Sepal.Length en el **eje X** 

- Petal.Length en el **eje Y**

- Species en el **color de los puntos**
]

--

Importante para entender ggplot2. Un gráfico tiene 3 componentes principales:
  
  - los **datos** que se van a representar  (.orange[ggplot()] )

  - un conjunto de **propiedades estéticas asociadas variables** del conjunto de datos. Por ejemplo, la posición en el eje X esta asociada a la variable Sepal.Length, el color de los puntos está asociado a los valores de la variable Species.  (  .orange[aes()] )

  - el **elemento geométrico que se va a representar**. En nuestro caso el elemento geométrico que usamos son  puntos, pero podrían haber sido las lineas o ...  (  .grey[geom_xx()], .orange[geom_point()] )

---



```r
ggplot(iris, aes(x = Sepal.Length, 
                 y = Petal.Length, 
                 color = Species)) + 
    geom_point()
```

&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-6-1.png" width="60%" style="display: block; margin: auto;" /&gt;

--
##### Forma más común de escribirlo


```r
ggplot(iris, aes(Sepal.Length, Petal.Length, color = Species)) + 
    geom_point()
```


---



count: false
 
#### Gráfico en slow-motion!
.panel1-grafico-00-auto[

```r
*iris
```
]
 
.panel2-grafico-00-auto[

```
#&gt;     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
#&gt; 1            5.1         3.5          1.4         0.2     setosa
#&gt; 2            4.9         3.0          1.4         0.2     setosa
#&gt; 3            4.7         3.2          1.3         0.2     setosa
#&gt; 4            4.6         3.1          1.5         0.2     setosa
#&gt; 5            5.0         3.6          1.4         0.2     setosa
#&gt; 6            5.4         3.9          1.7         0.4     setosa
#&gt; 7            4.6         3.4          1.4         0.3     setosa
#&gt; 8            5.0         3.4          1.5         0.2     setosa
#&gt; 9            4.4         2.9          1.4         0.2     setosa
#&gt; 10           4.9         3.1          1.5         0.1     setosa
#&gt; 11           5.4         3.7          1.5         0.2     setosa
#&gt; 12           4.8         3.4          1.6         0.2     setosa
#&gt; 13           4.8         3.0          1.4         0.1     setosa
#&gt; 14           4.3         3.0          1.1         0.1     setosa
#&gt; 15           5.8         4.0          1.2         0.2     setosa
#&gt; 16           5.7         4.4          1.5         0.4     setosa
#&gt; 17           5.4         3.9          1.3         0.4     setosa
#&gt; 18           5.1         3.5          1.4         0.3     setosa
#&gt; 19           5.7         3.8          1.7         0.3     setosa
#&gt; 20           5.1         3.8          1.5         0.3     setosa
#&gt; 21           5.4         3.4          1.7         0.2     setosa
#&gt; 22           5.1         3.7          1.5         0.4     setosa
#&gt; 23           4.6         3.6          1.0         0.2     setosa
#&gt; 24           5.1         3.3          1.7         0.5     setosa
#&gt; 25           4.8         3.4          1.9         0.2     setosa
#&gt; 26           5.0         3.0          1.6         0.2     setosa
#&gt; 27           5.0         3.4          1.6         0.4     setosa
#&gt; 28           5.2         3.5          1.5         0.2     setosa
#&gt; 29           5.2         3.4          1.4         0.2     setosa
#&gt; 30           4.7         3.2          1.6         0.2     setosa
#&gt; 31           4.8         3.1          1.6         0.2     setosa
#&gt; 32           5.4         3.4          1.5         0.4     setosa
#&gt; 33           5.2         4.1          1.5         0.1     setosa
#&gt; 34           5.5         4.2          1.4         0.2     setosa
#&gt; 35           4.9         3.1          1.5         0.2     setosa
#&gt; 36           5.0         3.2          1.2         0.2     setosa
#&gt; 37           5.5         3.5          1.3         0.2     setosa
#&gt; 38           4.9         3.6          1.4         0.1     setosa
#&gt; 39           4.4         3.0          1.3         0.2     setosa
#&gt; 40           5.1         3.4          1.5         0.2     setosa
#&gt; 41           5.0         3.5          1.3         0.3     setosa
#&gt; 42           4.5         2.3          1.3         0.3     setosa
#&gt; 43           4.4         3.2          1.3         0.2     setosa
#&gt; 44           5.0         3.5          1.6         0.6     setosa
#&gt; 45           5.1         3.8          1.9         0.4     setosa
#&gt; 46           4.8         3.0          1.4         0.3     setosa
#&gt; 47           5.1         3.8          1.6         0.2     setosa
#&gt; 48           4.6         3.2          1.4         0.2     setosa
#&gt; 49           5.3         3.7          1.5         0.2     setosa
#&gt; 50           5.0         3.3          1.4         0.2     setosa
#&gt; 51           7.0         3.2          4.7         1.4 versicolor
#&gt; 52           6.4         3.2          4.5         1.5 versicolor
#&gt; 53           6.9         3.1          4.9         1.5 versicolor
#&gt; 54           5.5         2.3          4.0         1.3 versicolor
#&gt; 55           6.5         2.8          4.6         1.5 versicolor
#&gt; 56           5.7         2.8          4.5         1.3 versicolor
#&gt; 57           6.3         3.3          4.7         1.6 versicolor
#&gt; 58           4.9         2.4          3.3         1.0 versicolor
#&gt; 59           6.6         2.9          4.6         1.3 versicolor
#&gt; 60           5.2         2.7          3.9         1.4 versicolor
#&gt; 61           5.0         2.0          3.5         1.0 versicolor
#&gt; 62           5.9         3.0          4.2         1.5 versicolor
#&gt; 63           6.0         2.2          4.0         1.0 versicolor
#&gt; 64           6.1         2.9          4.7         1.4 versicolor
#&gt; 65           5.6         2.9          3.6         1.3 versicolor
#&gt; 66           6.7         3.1          4.4         1.4 versicolor
#&gt; 67           5.6         3.0          4.5         1.5 versicolor
#&gt; 68           5.8         2.7          4.1         1.0 versicolor
#&gt; 69           6.2         2.2          4.5         1.5 versicolor
#&gt; 70           5.6         2.5          3.9         1.1 versicolor
#&gt; 71           5.9         3.2          4.8         1.8 versicolor
#&gt; 72           6.1         2.8          4.0         1.3 versicolor
#&gt; 73           6.3         2.5          4.9         1.5 versicolor
#&gt; 74           6.1         2.8          4.7         1.2 versicolor
#&gt; 75           6.4         2.9          4.3         1.3 versicolor
#&gt; 76           6.6         3.0          4.4         1.4 versicolor
#&gt; 77           6.8         2.8          4.8         1.4 versicolor
#&gt; 78           6.7         3.0          5.0         1.7 versicolor
#&gt; 79           6.0         2.9          4.5         1.5 versicolor
#&gt; 80           5.7         2.6          3.5         1.0 versicolor
#&gt; 81           5.5         2.4          3.8         1.1 versicolor
#&gt; 82           5.5         2.4          3.7         1.0 versicolor
#&gt; 83           5.8         2.7          3.9         1.2 versicolor
#&gt; 84           6.0         2.7          5.1         1.6 versicolor
#&gt; 85           5.4         3.0          4.5         1.5 versicolor
#&gt; 86           6.0         3.4          4.5         1.6 versicolor
#&gt; 87           6.7         3.1          4.7         1.5 versicolor
#&gt; 88           6.3         2.3          4.4         1.3 versicolor
#&gt; 89           5.6         3.0          4.1         1.3 versicolor
#&gt; 90           5.5         2.5          4.0         1.3 versicolor
#&gt; 91           5.5         2.6          4.4         1.2 versicolor
#&gt; 92           6.1         3.0          4.6         1.4 versicolor
#&gt; 93           5.8         2.6          4.0         1.2 versicolor
#&gt; 94           5.0         2.3          3.3         1.0 versicolor
#&gt; 95           5.6         2.7          4.2         1.3 versicolor
#&gt; 96           5.7         3.0          4.2         1.2 versicolor
#&gt; 97           5.7         2.9          4.2         1.3 versicolor
#&gt; 98           6.2         2.9          4.3         1.3 versicolor
#&gt; 99           5.1         2.5          3.0         1.1 versicolor
#&gt; 100          5.7         2.8          4.1         1.3 versicolor
#&gt; 101          6.3         3.3          6.0         2.5  virginica
#&gt; 102          5.8         2.7          5.1         1.9  virginica
#&gt; 103          7.1         3.0          5.9         2.1  virginica
#&gt; 104          6.3         2.9          5.6         1.8  virginica
#&gt; 105          6.5         3.0          5.8         2.2  virginica
#&gt; 106          7.6         3.0          6.6         2.1  virginica
#&gt; 107          4.9         2.5          4.5         1.7  virginica
#&gt; 108          7.3         2.9          6.3         1.8  virginica
#&gt; 109          6.7         2.5          5.8         1.8  virginica
#&gt; 110          7.2         3.6          6.1         2.5  virginica
#&gt; 111          6.5         3.2          5.1         2.0  virginica
#&gt; 112          6.4         2.7          5.3         1.9  virginica
#&gt; 113          6.8         3.0          5.5         2.1  virginica
#&gt; 114          5.7         2.5          5.0         2.0  virginica
#&gt; 115          5.8         2.8          5.1         2.4  virginica
#&gt; 116          6.4         3.2          5.3         2.3  virginica
#&gt; 117          6.5         3.0          5.5         1.8  virginica
#&gt; 118          7.7         3.8          6.7         2.2  virginica
#&gt; 119          7.7         2.6          6.9         2.3  virginica
#&gt; 120          6.0         2.2          5.0         1.5  virginica
#&gt; 121          6.9         3.2          5.7         2.3  virginica
#&gt; 122          5.6         2.8          4.9         2.0  virginica
#&gt; 123          7.7         2.8          6.7         2.0  virginica
#&gt; 124          6.3         2.7          4.9         1.8  virginica
#&gt; 125          6.7         3.3          5.7         2.1  virginica
#&gt; 126          7.2         3.2          6.0         1.8  virginica
#&gt; 127          6.2         2.8          4.8         1.8  virginica
#&gt; 128          6.1         3.0          4.9         1.8  virginica
#&gt; 129          6.4         2.8          5.6         2.1  virginica
#&gt; 130          7.2         3.0          5.8         1.6  virginica
#&gt; 131          7.4         2.8          6.1         1.9  virginica
#&gt; 132          7.9         3.8          6.4         2.0  virginica
#&gt; 133          6.4         2.8          5.6         2.2  virginica
#&gt; 134          6.3         2.8          5.1         1.5  virginica
#&gt; 135          6.1         2.6          5.6         1.4  virginica
#&gt; 136          7.7         3.0          6.1         2.3  virginica
#&gt; 137          6.3         3.4          5.6         2.4  virginica
#&gt; 138          6.4         3.1          5.5         1.8  virginica
#&gt; 139          6.0         3.0          4.8         1.8  virginica
#&gt; 140          6.9         3.1          5.4         2.1  virginica
#&gt; 141          6.7         3.1          5.6         2.4  virginica
#&gt; 142          6.9         3.1          5.1         2.3  virginica
#&gt; 143          5.8         2.7          5.1         1.9  virginica
#&gt; 144          6.8         3.2          5.9         2.3  virginica
#&gt; 145          6.7         3.3          5.7         2.5  virginica
#&gt; 146          6.7         3.0          5.2         2.3  virginica
#&gt; 147          6.3         2.5          5.0         1.9  virginica
#&gt; 148          6.5         3.0          5.2         2.0  virginica
#&gt; 149          6.2         3.4          5.4         2.3  virginica
#&gt; 150          5.9         3.0          5.1         1.8  virginica
```
]

---
count: false
 
#### Gráfico en slow-motion!
.panel1-grafico-00-auto[

```r
iris %&gt;%
*ggplot()
```
]
 
.panel2-grafico-00-auto[
&lt;img src="ss_06_ggplot2_A_files/figure-html/grafico-00_auto_02_output-1.png" width="95%" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
#### Gráfico en slow-motion!
.panel1-grafico-00-auto[

```r
iris %&gt;%
ggplot() +
*  aes(x = Sepal.Length)
```
]
 
.panel2-grafico-00-auto[
&lt;img src="ss_06_ggplot2_A_files/figure-html/grafico-00_auto_03_output-1.png" width="95%" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
#### Gráfico en slow-motion!
.panel1-grafico-00-auto[

```r
iris %&gt;%
ggplot() +
   aes(x = Sepal.Length) +
*  aes(y = Petal.Length)
```
]
 
.panel2-grafico-00-auto[
&lt;img src="ss_06_ggplot2_A_files/figure-html/grafico-00_auto_04_output-1.png" width="95%" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
#### Gráfico en slow-motion!
.panel1-grafico-00-auto[

```r
iris %&gt;%
ggplot() +
   aes(x = Sepal.Length) +
   aes(y = Petal.Length) +
*  aes(color = Species)
```
]
 
.panel2-grafico-00-auto[
&lt;img src="ss_06_ggplot2_A_files/figure-html/grafico-00_auto_05_output-1.png" width="95%" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
#### Gráfico en slow-motion!
.panel1-grafico-00-auto[

```r
iris %&gt;%
ggplot() +
   aes(x = Sepal.Length) +
   aes(y = Petal.Length) +
   aes(color = Species)  +
* geom_point()
```
]
 
.panel2-grafico-00-auto[
&lt;img src="ss_06_ggplot2_A_files/figure-html/grafico-00_auto_06_output-1.png" width="95%" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-grafico-00-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-grafico-00-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-grafico-00-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



##### La forma habitual de escribirlo es:



```r
ggplot(iris, aes(Sepal.Length, Petal.Length, color = Species)) + 
    geom_point()
```

---
##### IMAGINA que harán las siguientes instrucciones. Después las ejecutas.



```r
#- Fíjate: `sólo` hay `2 variables en aes()` -------------------------------------

ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
  geom_point()

#- Fíjate: ahora usamos `geom_line()` ------------------------------------------

ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
  geom_line() 

#- Fíjate: Ahora usamos `2 geom_xx`---------------------------------------------
ggplot(iris, aes(Sepal.Length, Petal.Length)) + geom_point() +  
      geom_smooth() 


#- Fíjate: volvemos a tener 3 variables asociadas a estéticas ----------------

ggplot(iris, aes(Sepal.Length, Petal.Length, color = Species)) + 
  geom_point()

#- Fíjate**: hay `argumentos dentro de geom_point()`---------------------------- 
#- Uno de ellos es `color`

ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
      geom_point(color = "red", size = 2, alpha = 0.2) 
```


---
class: inverse, center, middle
background-image: url(imagenes/ss_06_img_01_ggplot2-hex.png)
background-position: 95% 5%
background-size: 10%

### Entendiendo un poco más *ggplot2*

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

#### Ya tenemos las primeras ideas sobre ggplot2, ahora se trata de profundizar un poco para que podamos tener más control y flexibilidad al hacer nuestros gráficos.



---
####  Vamos a profundizar un poco más en *ggplot2*

Es importante que veas que estas 3 expresiones **hacen el mismo gráfico**:


```r
ggplot(iris, aes(Sepal.Length, Petal.Length)) + geom_point()

ggplot(iris) + geom_point(aes(Sepal.Length, Petal.Length))

ggplot() + geom_point(data = iris, aes(Sepal.Length, Petal.Length))
```

.purple[<i class="fas  fa-check-circle "></i>]  Si utilizas la *tercera expresión*; es decir, si especificas los datos dentro de geom_xx(), es necesario poner el nombre del argumento: (.red[data = iris] , ...)

--

&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-11-1.png" width="66%" style="display: block; margin: auto;" /&gt;

---

#### Repito esto porque es importante ....


- Podemos especificar los **mappings** de variables en estéticas dentro de cada *geom_xx()* 


```r
ggplot(iris) + geom_point(aes(Sepal.Length, Petal.Length))
```

--
&lt;br&gt;

- Podemos especificar los **datos** dentro de cada *geom_xx()* . En este caso no te olvides de poner (.red[data = ...])


```r
ggplot() + geom_point(data = iris, aes(Sepal.Length, Petal.Length))
```

--

&lt;br&gt;

---------------------

- Bueno, sí ¿Y que más da? Pues importa y muuuuccho. 

- Esto **nos va a dar mucha flexibilidad**/control a nuestros gráficos. Lo vemos


---
##### ¿Qué hacen estas 3 expresiones?


```r
ggplot(iris, aes(Sepal.Length, Petal.Length, color = Species)) + 
     geom_point() + geom_smooth()

ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
    geom_point(aes(color = Species)) + geom_smooth()

ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
    geom_point() + geom_smooth(aes(color = Species))
```

--




&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

##### Ejemplos: ¿Por qué no funcionan 3 de estas 4 expresiones?



```r
ggplot(iris) + geom_point(aes(Sepal.Length, Petal.Length)) + 
    geom_smooth(aes(color = Species))
#&gt; Error: stat_smooth requires the following missing aesthetics: x and y

ggplot() + geom_point(data = iris, aes(Sepal.Length, Petal.Length)) + 
    geom_line(aes(Sepal.Length, Petal.Length))
#&gt; Error in FUN(X[[i]], ...): objeto 'Sepal.Length' no encontrado

ggplot(aes(Sepal.Length, Petal.Length)) + geom_point(data = iris) + 
    geom_line()
#&gt; Error: `data` must be a data frame, or other object coercible by `fortify()`, not an S3 object with class uneval
#&gt; Did you accidentally pass `aes()` to the `data` argument?

ggplot() + geom_point(data = iris, aes(Sepal.Length, Petal.Length)) + 
    geom_line()
```

&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-17-1.png" width="55%" style="display: block; margin: auto;" /&gt;

---
##### Un ejemplo un poco marciano


```r
iris2 &lt;- iris %&gt;% filter(Species != "setosa") #- lirios que no son "setosa"

ggplot() + 
geom_point(data = iris, aes(Sepal.Length, Petal.Length, color = Species)) +
   geom_smooth(data = iris2, aes(Sepal.Length, Petal.Length) ) 

ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
  geom_point(aes(color = Species)) + geom_smooth(data = iris2)
```

--

&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---
###### Otro ejemplo/tarea más: 


.panelset[
.panel[.panel-name[Tarea]

Quiero que las 2 especies de lirios grandes se representen con el mismo color, ¿cómo lo hago?

Hay varias soluciones, una de las más marcianas es la Solución 1.
]
.panel[.panel-name[Solución 1]


```r
iris_setosa &lt;- iris %&gt;% filter(Species == "setosa") #- me quedo con los lirios pequeños, los de clase "setosa"

ggplot(iris, aes(Sepal.Length, Petal.Length)) + geom_point() + 
    geom_point(data = iris_setosa, aes(color = Species)) + 
    geom_smooth(data = iris2, aes(Sepal.Length, Petal.Length) )
```

&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Solución 2]

```r
iris_solo_2_clases &lt;- iris %&gt;% 
  mutate(Species_2 = ifelse(Species %in% c("versicolor", "virginica"), "versi_virgi", "setosa"))

ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
  geom_point() + 
  geom_point(data = iris_setosa, aes(color = Species)) +
  geom_smooth(data = iris_solo_2_clases,aes(Sepal.Length, Petal.Length, color = Species_2) )
```

&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /&gt;

]
.panel[.panel-name[Solución 3 (good)]

```r
iris_solo_2_clases &lt;- iris %&gt;% 
  mutate(Species_2 = ifelse(Species %in% c("versicolor", "virginica"), "versi_virgi", "setosa"))

ggplot(iris_solo_2_clases, aes(Sepal.Length, Petal.Length, color = Species_2)) + 
  geom_point() + geom_smooth()
```

&lt;img src="ss_06_ggplot2_A_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]
]

---
#### Un ejemplo más

- Para ir acabando con la “filosofía”/sintaxis/gramática de ggplot2 **intenta imaginar** que gráficos hacen las 6 expresiones de más abajo.

- Si no puedes, recuerda que siempre puedes ejecutar las ordenes en el ordenador. Fíjate sobre todo en la **tercera expresión**


```r
ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
  geom_point() + geom_smooth()

ggplot(iris, aes(Sepal.Length, Petal.Length, color = Species)) + 
  geom_point() + geom_smooth()

ggplot(iris, aes(Sepal.Length, Petal.Length, color = Species)) + 
   geom_point(color = "purple") + geom_smooth()

ggplot(iris, aes(Sepal.Length, Petal.Length, color = Species)) + 
  geom_point() + geom_smooth(color = "brown")

ggplot(iris, aes(Sepal.Length, Petal.Length)) + 
  geom_point() + geom_smooth(aes(color = Species))

ggplot(iris) + 
  geom_point(aes(Sepal.Length, Petal.Length, color = Species) ) +
  geom_smooth(aes(Sepal.Length, Petal.Length, color = Species))
```



---
class: inverse, center, middle
background-image: url(imagenes/ss_06_img_01_ggplot2-hex.png)
background-position: 95% 5%
background-size: 10%

## Más elementos de *ggplot2*

&lt;html&gt;&lt;div style='float:left'&gt;&lt;/div&gt;&lt;hr color='#EB811B' size=1px width=796px&gt;&lt;/html&gt;

##### Como puedes imaginar, aún tenemos que ver más elementos de ggplot2: los títulos y leyendas, los ejes, el tema, coordenadas, etc… vamos a ello!!

---
#### Más elementos de un ggplot()

- Ya hemos presentado los principales elementos de los gráficos hechos con ggplot2, pero es evidente que **un gráfico tiene más elementos**.

- Lógicamente, **hay que conocerlos un poco** para poder ajustar los gráficos a nuestras necesidades y mejorar su calidad. 

--

--------------------

Veremos algo de los siguientes elementos:

- Títulos del gráfico 
- Themes  
- Small multiples (o Facetting)
- Anotaciones  
- Ejes  
- Escalas  
- Stats (transformaciones estadísticas)  
- Position adjustments  
- Coordenadas  

----------------------------------

 .bg-washed-green.b--dark-green.ba.bw2.br3.shadow-5.ph4.mt5[
    Será en las siguientes slides]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
